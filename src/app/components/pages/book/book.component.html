<!-- About-->
<section class="page-section" id="books" data-testid="books-section" [ngClass]="currentClass()">
  <div class="container">
    <div class="text-center">
      <h2 class="section-heading text-uppercase">{{ 'books.title' | translate }}</h2>
      <h3 class="section-subheading text-muted mb-3">
        {{ 'books.subtitle' | translate }}&nbsp;&nbsp;&nbsp;&nbsp;<span
          class="badge rounded-pill bg-warning fs-7 text-dark"
          >{{
            'books.quantity' | translate: { count: filteredAndSortedBooks().length.toString() }
          }}</span
        >
      </h3>
    </div>

    <div class="border border-1 rounded mb-2">
      <div>
        <div class="text-center bg-light bg-gradient">
          <div class="s">
            <fieldset
              class="btn-group-sm"
              role="group"
              aria-label="Basic checkbox toggle button group"
              id="group_label_book_institution"
            >
              <button
                type="button"
                class="btn btn-primary btn-sm ms-3 mt-1 pt-0 pb-0 d-flex float-start"
                (click)="clearFilters()"
                [attr.aria-label]="'books.ariaClearFilters' | translate"
                [attr.title]="'books.clearFilters' | translate"
              >
                {{ 'books.clearFilters' | translate }}
              </button>

              <b class="p-1 m-1">{{ 'books.filterPublisher' | translate }}:</b>
              @for (
                publishName of publishNameList | enumToArray | sortby: 'value' : 'asc';
                track trackByPublisher($index, publishName)
              ) {
                <input
                  type="checkbox"
                  class="btn-check"
                  id="input_book_institution_{{ publishName.key }}"
                  autocomplete="off"
                  [checked]="isPublisherSelected(publishName.key)"
                  (click)="onClickIntitutionEvent($event)"
                />
                <label
                  class="btn btn-sm fontemenor p-1 ms-0"
                  for="input_book_institution_{{ publishName.key }}"
                  id="label_book_institution_{{ publishName.key }}"
                  [ngClass]="{ active: isPublisherSelected(publishName.key) }"
                  appHighlight
                  >{{ publishName.value }}</label
                >
              }
            </fieldset>
          </div>
        </div>
        <hr class="p-0 m-1" />
        <div>
          <div class="text-center bg-light bg-gradient">
            <div class="has-text-centered">
              <fieldset
                class="btn-group-sm"
                role="group"
                aria-label="Basic checkbox toggle button group"
              >
                <b class="p-1 m-1">{{ 'books.filterTag' | translate }}:</b>
                @for (tag of availableTags(); track trackByTag($index, tag)) {
                  <input
                    type="checkbox"
                    class="btn-check"
                    id="input_book_tag_{{ tag | lowercase }}"
                    autocomplete="off"
                    [checked]="tagsFilter().has(tag)"
                    (click)="onClickTagEvent($event)"
                  />
                  <label
                    class="btn btn-sm fontemenor p-1 ms-0"
                    for="input_book_tag_{{ tag | lowercase }}"
                    id="label_book_tag_{{ tag | lowercase }}"
                    [ngClass]="{ active: tagsFilter().has(tag) }"
                    appHighlight
                    >{{ tag }}</label
                  >
                }
              </fieldset>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="fontemenor12 pb-1" style="margin-left: 140px">
      <i class="bi bi-star-fill" style="color: #ffc107"></i> {{ 'books.favorite' | translate }}
    </div>
    <ul class="list-group list-group-light mb-4">
      @for (
        item of filteredAndSortedBooks() | paginate: config();
        track trackByBook($index, item);
        let i = $index
      ) {
        <li
          class="list-group-item d-flex justify-content-between align-items-center"
          data-testid="book-card"
        >
          <div class="d-flex align-items-center ms-5">
            <img
              [ngSrc]="getPublisherLogo(item.publishName)"
              [alt]="'books.logoAlt' | translate: { name: item.publishName }"
              width="60"
              height="60"
              class="rounded-circle publisher-logo"
              decoding="async"
            />
            <div class="ms-3">
              <p class="fw-bold mb-0">
                {{ item.title }}
                <i
                  class="bi bi-star-fill fontemenor12"
                  style="color: #ffc107"
                  [hidden]="!item.favorite"
                ></i
                >&nbsp;&nbsp;<span class="text-muted fontemenor11">
                  ( {{ 'books.publishedIn' | translate }} {{ item.publishYear }} )</span
                >
              </p>
              <p class="text-muted fontemenor">
                <b>{{ 'books.subtitle_label' | translate }}:</b> {{ item.subtitle }}
              </p>
              <p class="text-muted fontemenor">
                <b>{{ 'books.publisher' | translate }}: </b>
                {{ item.publishName }} &nbsp;&nbsp;&nbsp;&nbsp;<b
                  >{{ 'books.author' | translate }}:
                </b>
                {{ item.author | printTags }}
              </p>
              <p class="text-muted fontemenor">
                <b>{{ 'books.tags' | translate }}: </b> {{ item.tags | printTags }} &nbsp;<span
                  class="text-muted fontemenor11"
                  >&nbsp;&nbsp;&nbsp;<a
                    [href]="item.bookUrl"
                    target="_blank"
                    rel="noopener"
                    (click)="onBookUrlClick(item.title, item.publishName)"
                    >{{ 'books.moreDetails' | translate }}</a
                  ></span
                >
              </p>
            </div>
          </div>
          <span class="position-absolute top-50 ms-3 translate-middle badge rounded-pill bg-danger">
            {{ absoluteIndex(i) }}
            <span class="visually-hidden">{{ 'books.unreadMessages' | translate }}</span>
          </span>
        </li>
      }
    </ul>
    <div class="text-center">
      <div class="has-text-centered">
        <pagination-controls
          (pageChange)="onPageChange($event)"
          id="booksPag"
        ></pagination-controls>
      </div>
    </div>
  </div>
</section>
